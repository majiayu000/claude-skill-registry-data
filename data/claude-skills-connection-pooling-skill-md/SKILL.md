---
name: .claude/skills/connection-pooling/SKILL.md
description: |
    ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç®¡ç†ã®å°‚é–€ã‚¹ã‚­ãƒ«ã€‚
    ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§ã®æ¥ç¶šç®¡ç†ã€Tursoã®æ¥ç¶šç®¡ç†ã¨Embedded Replicasã€
    é«˜è² è·æ™‚ã®æ¥ç¶šæœ€é©åŒ–ã‚’å°‚é–€ã¨ã—ã¾ã™ã€‚
    å°‚é–€åˆ†é‡:
    - æ¥ç¶šç®¡ç†è¨­è¨ˆ: ç’°å¢ƒã«å¿œã˜ãŸæœ€é©ãªæ¥ç¶šè¨­å®š
    - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å¯¾å¿œ: Tursoã§ã®libSQLæ¥ç¶šç®¡ç†ã¨Embedded Replicas
    - Drizzle ORMçµ±åˆ: Drizzleã§ã®libSQLæ¥ç¶šè¨­å®š
    - éšœå®³å¯¾ç­–: æ¥ç¶šã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªãƒˆãƒ©ã‚¤
    - ç›£è¦–: æ¥ç¶šçŠ¶æ…‹ã®ç›£è¦–ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ
    ä½¿ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°:
    - æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§DBæ¥ç¶šã‚’è¨­å®šã™ã‚‹æ™‚
    - æ¥ç¶šè¨­å®šã®ã‚µã‚¤ã‚¸ãƒ³ã‚°ã‚’æ±ºã‚ã‚‹æ™‚
    - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§ã®æ¥ç¶šå•é¡Œã‚’è§£æ±ºã™ã‚‹æ™‚
    - æ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒé »ç™ºã™ã‚‹æ™‚
    - é«˜è² è·æ™‚ã®æ¥ç¶šæœ€é©åŒ–ãŒå¿…è¦ãªæ™‚
    Use proactively when setting up database connections,
    troubleshooting connection issues, or optimizing for serverless.

  ğŸ“š ãƒªã‚½ãƒ¼ã‚¹å‚ç…§:
  ã“ã®ã‚¹ã‚­ãƒ«ã«ã¯ä»¥ä¸‹ã®ãƒªã‚½ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
  å¿…è¦ã«å¿œã˜ã¦è©²å½“ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’å‚ç…§ã—ã¦ãã ã•ã„:

  - `.claude/skills/connection-pooling/resources/error-handling.md`: æ¥ç¶šã‚¨ãƒ©ãƒ¼ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥
  - `.claude/skills/connection-pooling/resources/pool-sizing-guide.md`: ç’°å¢ƒåˆ¥ãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚ºè¨­å®šã¨è¨ˆç®—å¼
  - `.claude/skills/connection-pooling/resources/serverless-connections.md`: Tursoã§ã®ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹libSQLæ¥ç¶šç®¡ç†
  - `.claude/skills/connection-pooling/templates/drizzle-config-template.ts`: Drizzle ORMæ¥ç¶šè¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  - `.claude/skills/connection-pooling/scripts/check-connections.mjs`: æ¥ç¶šçŠ¶æ…‹ã®ç¢ºèªã¨è¨ºæ–­ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

version: 1.0.0
---

# Connection Pooling

## æ¦‚è¦

ã“ã®ã‚¹ã‚­ãƒ«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç®¡ç†ã®è¨­è¨ˆã¨å®Ÿè£…ã«é–¢ã™ã‚‹
çŸ¥è­˜ã‚’æä¾›ã—ã¾ã™ã€‚ç‰¹ã«ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒï¼ˆTursoï¼‰ã§ã®
libSQLæ¥ç¶šç®¡ç†ã¨Embedded Replicasã«ç„¦ç‚¹ã‚’å½“ã¦ã¦ã„ã¾ã™ã€‚

**ä¸»è¦ãªä¾¡å€¤**:

- ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§ã®å®‰å®šã—ãŸæ¥ç¶š
- Embedded Replicasã«ã‚ˆã‚‹ãƒ­ãƒ¼ã‚«ãƒ«â†”ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸ
- é«˜è² è·æ™‚ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¶­æŒ
- æ¥ç¶šãƒªã‚½ãƒ¼ã‚¹ã®åŠ¹ç‡çš„ãªåˆ©ç”¨

**å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**:

- `.claude/agents/dba-mgr.md`ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…
- DevOpsã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- SREãƒãƒ¼ãƒ 

## ãƒªã‚½ãƒ¼ã‚¹æ§‹é€ 

```
connection-pooling/
â”œâ”€â”€ SKILL.md                                    # æœ¬ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ pool-sizing-guide.md                   # ãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚¸ãƒ³ã‚°
â”‚   â”œâ”€â”€ serverless-connections.md              # ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹æ¥ç¶š
â”‚   â””â”€â”€ error-handling.md                      # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ check-connections.mjs                  # æ¥ç¶šçŠ¶æ…‹ç¢ºèª
â””â”€â”€ templates/
    â””â”€â”€ drizzle-config-template.ts             # Drizzleè¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```

## ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### ãƒªã‚½ãƒ¼ã‚¹èª­ã¿å–ã‚Š

```bash
# ãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚¸ãƒ³ã‚°
cat .claude/skills/connection-pooling/resources/pool-sizing-guide.md

# ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹æ¥ç¶š
cat .claude/skills/connection-pooling/resources/serverless-connections.md

# ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
cat .claude/skills/connection-pooling/resources/error-handling.md
```

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ

```bash
# æ¥ç¶šçŠ¶æ…‹ç¢ºèª
node .claude/skills/connection-pooling/scripts/check-connections.mjs
```

## ã„ã¤ä½¿ã†ã‹

### ã‚·ãƒŠãƒªã‚ª1: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**çŠ¶æ³**: æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§DBæ¥ç¶šã‚’è¨­å®šã™ã‚‹

**é©ç”¨æ¡ä»¶**:

- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ãŒæ±ºå®šæ¸ˆã¿
- [ ] æƒ³å®šè² è·ãŒè¦‹ç©ã‚‚ã‚‰ã‚Œã¦ã„ã‚‹
- [ ] å®Ÿè¡Œç’°å¢ƒãŒæ±ºã¾ã£ã¦ã„ã‚‹

**æœŸå¾…ã•ã‚Œã‚‹æˆæœ**: æœ€é©ãªæ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®š

### ã‚·ãƒŠãƒªã‚ª2: æ¥ç¶šã‚¨ãƒ©ãƒ¼ã®è§£æ±º

**çŠ¶æ³**: ã€Œtoo many connectionsã€ãªã©ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

**é©ç”¨æ¡ä»¶**:

- [ ] ã‚¨ãƒ©ãƒ¼ã®ç™ºç”Ÿãƒ‘ã‚¿ãƒ¼ãƒ³ãŒæŠŠæ¡ã§ãã¦ã„ã‚‹
- [ ] ç¾åœ¨ã®è¨­å®šãŒç¢ºèªã§ãã‚‹
- [ ] æ¥ç¶šæ•°ã®ç›£è¦–ãŒã§ãã‚‹

**æœŸå¾…ã•ã‚Œã‚‹æˆæœ**: å®‰å®šã—ãŸæ¥ç¶šè¨­å®š

### ã‚·ãƒŠãƒªã‚ª3: ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç§»è¡Œ

**çŠ¶æ³**: ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã¸ã®ç§»è¡Œã§æ¥ç¶šç®¡ç†ã‚’è¦‹ç›´ã™

**é©ç”¨æ¡ä»¶**:

- [ ] ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãŒæ±ºå®š
- [ ] æ¥ç¶šãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç†è§£ã•ã‚Œã¦ã„ã‚‹
- [ ] Embedded Replicasã®ä½¿ç”¨ã‚’æ¤œè¨ã—ã¦ã„ã‚‹

**æœŸå¾…ã•ã‚Œã‚‹æˆæœ**: ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å¯¾å¿œã®æ¥ç¶šè¨­å®š

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### Phase 1: è¦ä»¶åˆ†æ

**ç›®çš„**: æ¥ç¶šè¦ä»¶ã‚’æ˜ç¢ºåŒ–ã™ã‚‹

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **ç’°å¢ƒã®ç¢ºèª**:
   - ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ vs å¸¸é§ã‚µãƒ¼ãƒãƒ¼
   - Turso Cloud / Embedded Replicas / Self-hosted
   - ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°

2. **è² è·ã®è¦‹ç©ã‚‚ã‚Š**:
   - åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
   - ã‚¯ã‚¨ãƒªã®å®Ÿè¡Œæ™‚é–“
   - ãƒ”ãƒ¼ã‚¯æ™‚ã®è² è·

**åˆ¤æ–­åŸºæº–**:

- [ ] å®Ÿè¡Œç’°å¢ƒãŒæ˜ç¢ºã‹ï¼Ÿ
- [ ] è² è·ã®è¦‹ç©ã‚‚ã‚ŠãŒã‚ã‚‹ã‹ï¼Ÿ
- [ ] Embedded Replicasã®ä½¿ç”¨ã‚’æ¤œè¨ã—ãŸã‹ï¼Ÿ

**ãƒªã‚½ãƒ¼ã‚¹**: `resources/serverless-connections.md`

### Phase 2: æ¥ç¶šè¨­è¨ˆ

**ç›®çš„**: é©åˆ‡ãªæ¥ç¶šè¨­å®šã‚’æ±ºå®šã™ã‚‹

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **æ¥ç¶šè¨­å®šã®å®Ÿè£…**:

   ```typescript
   // Tursoæ¥ç¶šè¨­å®š
   const config = {
     url: process.env.TURSO_DATABASE_URL,
     authToken: process.env.TURSO_AUTH_TOKEN,
   };
   ```

2. **Embedded Replicasè¨­å®š**:
   ```typescript
   const client = createClient({
     url: "file:local.db", // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ãƒ—ãƒªã‚«
     syncUrl: process.env.TURSO_DATABASE_URL,
     authToken: process.env.TURSO_AUTH_TOKEN,
     syncInterval: 60, // 60ç§’ã”ã¨ã«åŒæœŸ
   });
   ```

**åˆ¤æ–­åŸºæº–**:

- [ ] æ¥ç¶šURLã¨ãƒˆãƒ¼ã‚¯ãƒ³ã¯è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] Embedded Replicasã®ä½¿ç”¨ã‚’æ¤œè¨ã—ãŸã‹ï¼Ÿ
- [ ] åŒæœŸé–“éš”ã¯é©åˆ‡ã‹ï¼Ÿ
- [ ] ãƒªãƒˆãƒ©ã‚¤è¨­å®šãŒã‚ã‚‹ã‹ï¼Ÿ

**ãƒªã‚½ãƒ¼ã‚¹**: `resources/pool-sizing-guide.md`

### Phase 3: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**ç›®çš„**: æ¥ç¶šã‚¨ãƒ©ãƒ¼ã«å¯¾ã™ã‚‹å›å¾©åŠ›ã‚’ç¢ºä¿ã™ã‚‹

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥**:
   - æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
   - æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°
   - ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ãªã‚¨ãƒ©ãƒ¼ã®å®šç¾©

2. **ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼**:
   - é€£ç¶šå¤±æ•—æ™‚ã®ã‚ªãƒ¼ãƒ—ãƒ³
   - å›å¾©è©¦è¡Œé–“éš”
   - åŠé–‹çŠ¶æ…‹ã®ç®¡ç†

**åˆ¤æ–­åŸºæº–**:

- [ ] ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒè¨˜éŒ²ã•ã‚Œã‚‹ã‹ï¼Ÿ

**ãƒªã‚½ãƒ¼ã‚¹**: `resources/error-handling.md`

### Phase 4: ç›£è¦–

**ç›®çš„**: æ¥ç¶šçŠ¶æ…‹ã‚’ç¶™ç¶šçš„ã«ç›£è¦–ã™ã‚‹

**ã‚¹ãƒ†ãƒƒãƒ—**:

1. **ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†**:
   - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ¥ç¶šæ•°
   - å¾…æ©Ÿä¸­ã®æ¥ç¶š
   - æ¥ç¶šã‚¨ãƒ©ãƒ¼ç‡

2. **ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š**:
   - æ¥ç¶šæ¯æ¸‡ã®è­¦å‘Š
   - ã‚¨ãƒ©ãƒ¼ç‡ã®é–¾å€¤
   - ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®ç›£è¦–

**åˆ¤æ–­åŸºæº–**:

- [ ] æ¥ç¶šæ•°ã®ç›£è¦–ãŒã‚ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒã‚ã‚‹ã‹ï¼Ÿ

## æ ¸å¿ƒæ¦‚å¿µ

### æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®åŸºæœ¬

```
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
    â”‚
    â”œâ”€â”€ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1 â”€â”€â†’ [æ¥ç¶š1]
    â”œâ”€â”€ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ2 â”€â”€â†’ [æ¥ç¶š2]  â†â”€â”€ æ¥ç¶šãƒ—ãƒ¼ãƒ«
    â”œâ”€â”€ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ3 â”€â”€â†’ [æ¥ç¶š3]       (å†åˆ©ç”¨)
    â””â”€â”€ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ4 â”€â”€â†’ [å¾…æ©Ÿ...]
                           â”‚
                           â–¼
                      ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```

### ãƒ—ãƒ¼ãƒ«ãƒ¢ãƒ¼ãƒ‰

| ãƒ¢ãƒ¼ãƒ‰      | èª¬æ˜                           | ç”¨é€”                 |
| ----------- | ------------------------------ | -------------------- |
| Session     | æ¥ç¶šã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨ä½“ã§ä¿æŒ     | é•·ã„ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ |
| Transaction | ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å˜ä½ã§å‰²ã‚Šå½“ã¦ | ä¸€èˆ¬çš„ãªWeb          |
| Statement   | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆå˜ä½ã§å‰²ã‚Šå½“ã¦   | é«˜é€Ÿãªã‚¯ã‚¨ãƒª         |

### ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç‰¹æœ‰ã®èª²é¡Œ

```
Lambda/Edge Function
    â”‚
    â”œâ”€â”€ ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆ â†’ æ–°è¦æ¥ç¶š
    â”‚                      (ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰)
    â”œâ”€â”€ ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ â†’ æ—¢å­˜æ¥ç¶šå†åˆ©ç”¨
    â”‚                      (é«˜é€Ÿ)
    â””â”€â”€ ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ â†’ æ¥ç¶šçˆ†ç™ºã®ãƒªã‚¹ã‚¯
                          (ãƒ—ãƒ¼ãƒ©ãƒ¼ã§åˆ¶å¾¡)
```

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã™ã¹ãã“ã¨

1. **é©åˆ‡ãªæ¥ç¶šæ–¹å¼ã‚’é¸æŠã™ã‚‹**:
   - Turso Cloud: HTTPSãƒ™ãƒ¼ã‚¹ã®æ¥ç¶š
   - Embedded Replicas: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ« + ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸ
   - Self-hosted: libSQL Server

2. **æ¥ç¶šã‚’é©åˆ‡ã«ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹**:

   ```typescript
   try {
     const result = await client.execute("SELECT * FROM users");
     return result;
   } finally {
     // libSQLã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯è‡ªå‹•çš„ã«æ¥ç¶šã‚’ç®¡ç†
     // Embedded Replicasã®å ´åˆã¯å®šæœŸçš„ã«åŒæœŸ
   }
   ```

3. **åŒæœŸè¨­å®šã‚’æœ€é©åŒ–ã™ã‚‹**:
   ```typescript
   const config = {
     syncInterval: 60, // åŒæœŸé–“éš”ï¼ˆç§’ï¼‰
     syncOnWrite: true, // æ›¸ãè¾¼ã¿æ™‚ã«åŒæœŸ
     readYourWrites: true, // è‡ªåˆ†ã®æ›¸ãè¾¼ã¿ã‚’å³åº§ã«èª­ã¿å–ã‚Š
   };
   ```

### é¿ã‘ã‚‹ã¹ãã“ã¨

1. **æ¥ç¶šã®ãƒªãƒ¼ã‚¯**:
   - âŒ æ¥ç¶šã‚’é–‰ã˜å¿˜ã‚Œã‚‹
   - âœ… try-finallyã§ç¢ºå®Ÿã«ãƒªãƒªãƒ¼ã‚¹

2. **ä¸é©åˆ‡ãªåŒæœŸè¨­å®š**:
   - âŒ åŒæœŸé–“éš”ãŒçŸ­ã™ãã‚‹ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è² è·ï¼‰
   - âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¦ä»¶ã«å¿œã˜ãŸé©åˆ‡ãªé–“éš”

3. **Embedded Replicasã®æœªæ´»ç”¨**:
   - âŒ ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ç’°å¢ƒã§å¸¸ã«ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶š
   - âœ… Embedded Replicasã§ãƒ­ãƒ¼ã‚«ãƒ«èª­ã¿å–ã‚Š + ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸ

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: åŒæœŸã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: Embedded Replicasã®åŒæœŸãŒå¤±æ•—

**åŸå› **:

- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®å•é¡Œ
- èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã®æœŸé™åˆ‡ã‚Œ
- åŒæœŸURLã®è¨­å®šãƒŸã‚¹

**è§£æ±ºç­–**:

```typescript
// åŒæœŸçŠ¶æ…‹ã®ç¢ºèª
const syncStatus = await client.sync();
console.log("Sync completed:", syncStatus);

// æ‰‹å‹•ã§å¼·åˆ¶åŒæœŸ
await client.sync();

// åŒæœŸã‚¨ãƒ©ãƒ¼ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
client.on("sync-error", (error) => {
  console.error("Sync failed:", error);
  // ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯
});
```

### å•é¡Œ2: æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**ç—‡çŠ¶**: Tursoã¸ã®æ¥ç¶šãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**åŸå› **:

- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é…å»¶
- èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã®å•é¡Œ
- ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãŒé ã„

**è§£æ±ºç­–**:

```typescript
// Embedded Replicasã‚’ä½¿ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«æ¥ç¶š
const client = createClient({
  url: "file:local.db",
  syncUrl: process.env.TURSO_DATABASE_URL,
  authToken: process.env.TURSO_AUTH_TOKEN,
});

// ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥
const retryConfig = {
  retries: 3,
  factor: 2,
  minTimeout: 1000,
  maxTimeout: 5000,
};
```

### å•é¡Œ3: ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆã®é…å»¶

**ç—‡çŠ¶**: Lambda/Edgeã®åˆå›ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé…ã„

**åŸå› **:

- ãƒªãƒ¢ãƒ¼ãƒˆDBæ¥ç¶šã®ç¢ºç«‹
- HTTPSé€šä¿¡ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰
- èªè¨¼å‡¦ç†

**è§£æ±ºç­–**:

- Embedded Replicasã®ä½¿ç”¨ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ï¼‰
- Provisioned Concurrencyã®ä½¿ç”¨
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

## é–¢é€£ã‚¹ã‚­ãƒ«

- **.claude/skills/query-performance-tuning/SKILL.md** (`.claude/skills/query-performance-tuning/SKILL.md`): ã‚¯ã‚¨ãƒªæœ€é©åŒ–
- **.claude/skills/backup-recovery/SKILL.md** (`.claude/skills/backup-recovery/SKILL.md`): ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

## ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### æ¥ç¶šãƒ—ãƒ¼ãƒ«å¥å…¨æ€§æŒ‡æ¨™

| æŒ‡æ¨™           | ç›®æ¨™å€¤  | è­¦å‘Šå€¤  |
| -------------- | ------- | ------- |
| æ¥ç¶šä½¿ç”¨ç‡     | < 80%   | > 90%   |
| å¾…æ©Ÿãƒªã‚¯ã‚¨ã‚¹ãƒˆ | 0       | > 10    |
| æ¥ç¶šã‚¨ãƒ©ãƒ¼ç‡   | < 0.1%  | > 1%    |
| å¹³å‡æ¥ç¶šæ™‚é–“   | < 100ms | > 500ms |

## å¤‰æ›´å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜       | å¤‰æ›´å†…å®¹                  |
| ---------- | ---------- | ------------------------- |
| 1.0.0      | 2025-11-27 | åˆç‰ˆä½œæˆ - æ¥ç¶šãƒ—ãƒ¼ãƒ«ç®¡ç† |

## å‚è€ƒæ–‡çŒ®

- **Turso Documentation**: https://docs.turso.tech/
- **libSQL**: https://github.com/tursodatabase/libsql
- **Embedded Replicas**: https://docs.turso.tech/features/embedded-replicas
