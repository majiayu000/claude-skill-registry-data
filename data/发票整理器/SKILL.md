---
name: invoice-organizer
description: 通过读取杂乱的发票、提取关键信息、一致地重命名并将它们分类到逻辑文件夹中，自动为税务准备整理发票和收据。将数小时的手动记账工作转化为几分钟的自动化组织。
---

# 发票整理器

此技能无需手动操作，即可将杂乱的发票、收据和财务文件夹转化为干净、税务准备就绪的归档系统。

## 何时使用此技能

- 准备税务季节，需要有组织的记录
- 管理多个供应商的商业支出
- 从杂乱的文件夹或邮件下载中整理收据
- 为持续的记账设置自动发票归档
- 按年份或类别归档财务记录
- 核对费用以进行报销
- 为会计师准备文档

## 此技能的作用

1. **读取发票内容**：从 PDF、图像和文档中提取信息：
   - 供应商/公司名称
   - 发票号码
   - 日期
   - 金额
   - 产品或服务描述
   - 付款方式

2. **一致地重命名文件**：创建标准化的文件名：
   - 格式：`YYYY-MM-DD 供应商 - 发票 - 产品或服务.pdf`
   - 示例：`2024-03-15 Adobe - 发票 - Creative Cloud.pdf`

3. **按类别组织**：分类到逻辑文件夹：
   - 按供应商
   - 按支出类别（软件、办公、出差等）
   - 按时间段（年、季度、月）
   - 按税务类别（可扣除、个人等）

4. **处理多种格式**：支持：
   - PDF 发票
   - 扫描收据（JPG、PNG）
   - 邮件附件
   - 截图
   - 银行对账单

5. **保留原件**：在组织副本时保留原始文件

## 如何使用

### 基本使用

导航到杂乱的发票文件夹：
```
cd ~/Desktop/receipts-to-sort
```

然后询问 Claude Code：
```
整理这些发票用于税务
```

或更具体地说：
```
读取此文件夹中的所有发票，将它们重命名为
"YYYY-MM-DD 供应商 - 发票 - 产品.pdf" 格式，
并按供应商组织
```

### 高级组织

```
整理这些发票：
1. 从每个文件中提取日期、供应商和描述
2. 重命名为标准格式
3. 按支出类别（软件、办公、出差等）分类到文件夹
4. 为我的会计师创建一个包含所有发票详细信息的 CSV 电子表格
```

## 说明

当用户请求发票组织时：

1. **扫描文件夹**

   识别所有发票文件：
   ```bash
   # 查找所有发票相关文件
   find . -type f \( -name "*.pdf" -o -name "*.jpg" -o -name "*.png" \) -print
   ```

   报告发现：
   - 文件总数
   - 文件类型
   - 日期范围（如果可以从名称中辨别）
   - 当前组织状态（或缺乏组织）

2. **从每个文件中提取信息**

   对于每张发票，提取：

   **从 PDF 发票**：
   - 使用文本提取读取发票内容
   - 查找常见模式：
     - "发票日期："、"日期："、"签发日期："
     - "发票 #："、"发票号码："
     - 公司名称（通常在顶部）
     - "应付金额："、"总计："、"金额："
     - "描述："、"服务："、"产品："

   **从图像收据**：
   - 从图像中读取可见文本
   - 识别供应商名称（通常在顶部）
   - 查找日期（常见格式）
   - 找到总金额

   **对于不清晰文件的备选方案**：
   - 使用文件名线索
   - 检查文件创建/修改日期
   - 如果缺少关键信息，标记为手动审核

3. **确定组织策略**

   如果未指定，询问用户偏好：

   ```markdown
   我找到了 [X] 张来自 [日期范围] 的发票。

   你希望如何组织它们？

   1. **按供应商**（Adobe/、Amazon/、Stripe/ 等）
   2. **按类别**（软件/、办公用品/、出差/ 等）
   3. **按日期**（2024/Q1/、2024/Q2/ 等）
   4. **按税务类别**（可扣除/、个人/ 等）
   5. **自定义**（描述你的结构）

   或者我可以使用默认结构：年/类别/供应商
   ```

4. **创建标准化的文件名**

   对于每张发票，按照以下模式创建文件名：

   ```
   YYYY-MM-DD 供应商 - 发票 - 描述.扩展名
   ```

   示例：
   - `2024-03-15 Adobe - 发票 - Creative Cloud.pdf`
   - `2024-01-10 Amazon - 收据 - 办公用品.pdf`
   - `2023-12-01 Stripe - 发票 - 月度支付处理.pdf`

   **文件名最佳实践**：
   - 删除特殊字符（连字符除外）
   - 正确大写供应商名称
   - 保持描述简洁但有意义
   - 使用一致的日期格式（YYYY-MM-DD）以便排序
   - 保留原始文件扩展名

5. **执行组织**

   在移动文件之前，显示计划：

   ```markdown
   # 组织计划

   ## 建议的结构
   ```
   Invoices/
   ├── 2023/
   │   ├── Software/
   │   │   ├── Adobe/
   │   │   └── Microsoft/
   │   ├── Services/
   │   └── Office/
   └── 2024/
       ├── Software/
       ├── Services/
       └── Office/
   ```

   ## 样本更改

   之前：`invoice_adobe_march.pdf`
   之后：`2024-03-15 Adobe - 发票 - Creative Cloud.pdf`
   位置：`Invoices/2024/Software/Adobe/`

   之前：`IMG_2847.jpg`
   之后：`2024-02-10 Staples - 收据 - 办公用品.jpg`
   位置：`Invoices/2024/Office/Staples/`

   处理 [X] 个文件？（是/否）
   ```

   批准后：
   ```bash
   # 创建文件夹结构
   mkdir -p "Invoices/2024/Software/Adobe"

   # 复制（不要移动）以保留原件
   cp "invoice_adobe_march.pdf" "Invoices/2024/Software/Adobe/2024-03-15 Adobe - 发票 - Creative Cloud.pdf"
   ```

6. **创建摘要（如果需要）**

   生成包含所有整理文件的 CSV 或摘要：

   ```csv
   文件名,日期,供应商,描述,金额,类别
   2024-03-15 Adobe - 发票 - Creative Cloud.pdf,2024-03-15,Adobe,Creative Cloud,$54.99,Software
   2024-02-10 Staples - 收据 - 办公用品.jpg,2024-02-10,Staples,办公用品,$23.47,Office
   ```

## 提示

- **备份原始文件**：始终复制而不是移动，直到确认组织正确
- **测试小批量**：首先用少量文件测试流程
- **使用描述性名称**：更好的文件名使未来查找更容易
- **保持一致**：对所有文件使用相同的命名约定
- **考虑你的税务情况**：按税务类别组织可以在报税时节省时间

## 故障排除

### 问题：无法从图像中读取文本

**解决方案**：
- 确保图像清晰且光线充足
- 尝试使用 OCR 工具
- 如果文本不可读，手动输入信息

### 问题：缺少关键信息

**解决方案**：
- 检查原始文件或邮件
- 使用文件修改日期作为近似发票日期
- 在 CSV 中标记为"待定"，以便手动审核

### 问题：供应商名称不一致

**解决方案**：
- 创建供应商名称标准化映射
- "Adobe Systems" 和 "Adobe Inc." 都映射到 "Adobe"
- 用户可以在流程中确认名称

### 问题：日期格式不一致

**解决方案**：
- 标准化为 YYYY-MM-DD
- 识别常见格式（MM/DD/YYYY、DD/MM/YYYY 等）
- 在转换前询问用户日期格式偏好
