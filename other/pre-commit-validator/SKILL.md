---
name: pre-commit-validator
description: Git commit å‰çš„å®Œæ•´é©—è­‰æª¢æŸ¥ã€‚ç•¶ç”¨æˆ¶æåˆ°ã€Œcommitã€ã€ã€Œæäº¤ã€ã€ã€Œpushã€æˆ–å®Œæˆé‡è¦ä¿®æ”¹æ™‚è‡ªå‹•åŸ·è¡Œã€‚
allowed-tools: Bash, Grep, Read
---

# Pre-Commit Validator Skill

åœ¨ Git commit å‰åŸ·è¡Œå®Œæ•´çš„ä»£ç¢¼å“è³ªé©—è­‰ï¼Œç¢ºä¿æ‰€æœ‰ä¿®æ”¹ç¬¦åˆæœ€é«˜è¦æ ¼æ¨™æº–ã€‚

## ğŸ¯ åŸ·è¡Œæ™‚æ©Ÿ

- ç”¨æˆ¶æåˆ°è¦ã€Œcommitã€æˆ–ã€Œæäº¤ä»£ç¢¼ã€
- ç”¨æˆ¶æåˆ°è¦ã€Œpushã€åˆ°é ç«¯
- å®Œæˆé‡è¦åŠŸèƒ½é–‹ç™¼å¾Œ
- ç”¨æˆ¶æ˜ç¢ºè¦æ±‚ã€Œæª¢æŸ¥ã€æˆ–ã€Œé©—è­‰ã€åœ¨æäº¤å‰

## ğŸ“‹ å®Œæ•´æª¢æŸ¥æ¸…å–®

### 1. Git ç‹€æ…‹æª¢æŸ¥

```bash
git status
```

ç¢ºèªï¼š

- âœ… æœ‰æœªæäº¤çš„ä¿®æ”¹
- âœ… åœ¨æ­£ç¢ºçš„åˆ†æ”¯ä¸Š
- âœ… æ²’æœ‰æœªè¿½è¹¤çš„é‡è¦æª”æ¡ˆè¢«éºæ¼

### 2. TypeScript é¡å‹æª¢æŸ¥

```bash
npm run typecheck
```

**å¿…é ˆé€šéï¼Œç„¡ä»»ä½•éŒ¯èª¤**

å¦‚æœæœ‰éŒ¯èª¤ï¼š

1. ä½¿ç”¨ `type-checker` skill ä¿®å¾©
2. é‡æ–°åŸ·è¡Œé©—è­‰
3. ä¸å¯è·³éæˆ–å¿½ç•¥

### 3. ESLint ä»£ç¢¼é¢¨æ ¼æª¢æŸ¥

```bash
npm run lint
```

**å¿…é ˆé€šéï¼Œç„¡ä»»ä½•è­¦å‘Šæˆ–éŒ¯èª¤**

å¦‚æœæœ‰éŒ¯èª¤ï¼š

1. å„ªå…ˆä½¿ç”¨è‡ªå‹•ä¿®å¾©: `npm run lint -- --fix`
2. æ‰‹å‹•ä¿®å¾©ç„¡æ³•è‡ªå‹•è™•ç†çš„å•é¡Œ
3. é‡æ–°åŸ·è¡Œé©—è­‰

### 4. å–®å…ƒæ¸¬è©¦ï¼ˆå¦‚æœæœ‰ï¼‰

```bash
npm test
```

æ‰€æœ‰æ¸¬è©¦å¿…é ˆé€šéã€‚

### 5. Build æ§‹å»ºæª¢æŸ¥

```bash
npm run build
```

**å¿…é ˆæˆåŠŸæ§‹å»ºï¼Œç„¡ä»»ä½•éŒ¯èª¤**

é€™ç¢ºä¿ï¼š

- æ‰€æœ‰ import/export æ­£ç¢º
- æ‰€æœ‰ä¾è³´å¯è§£æ
- ç”Ÿç”¢ç’°å¢ƒä»£ç¢¼å¯ç”¨

### 6. ç¦æ­¢æ¨¡å¼æœå°‹

ä½¿ç”¨ Grep æœå°‹çµ•å°ç¦æ­¢å‡ºç¾çš„æ¨¡å¼ï¼š

```bash
# æœå°‹ console.log (åƒ…åœ¨æ–°ä¿®æ”¹çš„æª”æ¡ˆä¸­)
git diff --name-only | xargs grep -n "console\.log"

# æœå°‹ debugger èªå¥
git diff --name-only | xargs grep -n "debugger"

# æœå°‹ TODO/FIXME æ¨™è¨˜
git diff --name-only | xargs grep -n "TODO\|FIXME"
```

å¦‚æœç™¼ç¾ï¼š

- `console.log` â†’ å¿…é ˆç§»é™¤æˆ–æ”¹ç”¨ logger
- `debugger` â†’ å¿…é ˆç§»é™¤
- `TODO`/`FIXME` â†’ ç¢ºèªæ˜¯å¦éœ€è¦åœ¨æ­¤ commit å®Œæˆ

### 7. æ•æ„Ÿè³‡è¨Šæª¢æŸ¥

```bash
# æª¢æŸ¥æ˜¯å¦åŒ…å« API keys, tokens, passwords
git diff --cached | grep -iE "(api[_-]?key|secret|password|token|credential)"
```

å¦‚æœç™¼ç¾æ•æ„Ÿè³‡è¨Šï¼š

- ğŸš¨ **ç«‹å³åœæ­¢ commit**
- ç§»é™¤æ•æ„Ÿè³‡è¨Š
- ä½¿ç”¨ç’°å¢ƒè®Šæ•¸æˆ–é…ç½®æª”æ¡ˆ

### 8. æª”æ¡ˆå¤§å°æª¢æŸ¥

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰å¤§æª”æ¡ˆï¼ˆ>1MBï¼‰
git diff --cached --name-only | xargs ls -lh | awk '$5 ~ /M/ {print}'
```

å¤§æª”æ¡ˆæ‡‰è©²ï¼š

- åœ–ç‰‡/åª’é«” â†’ ä½¿ç”¨ CDN æˆ–å£“ç¸®
- è³‡æ–™æª”æ¡ˆ â†’ ä¸æ‡‰æäº¤åˆ° git

### 9. ç›¸ä¾æ€§æª¢æŸ¥

```bash
# æª¢æŸ¥ package.json æ˜¯å¦æœ‰è®Šæ›´
git diff --name-only | grep "package.json"
```

å¦‚æœ `package.json` æœ‰è®Šæ›´ï¼š

- ç¢ºèª `package-lock.json` ä¹Ÿæœ‰è®Šæ›´
- åŸ·è¡Œ `npm install` ç¢ºä¿ä¾è³´æ­£ç¢º

## ğŸ“ é©—è­‰å ±å‘Šæ ¼å¼

```markdown
## Pre-Commit é©—è­‰å ±å‘Š

### Git ç‹€æ…‹

- åˆ†æ”¯: `feature/xxx`
- ä¿®æ”¹æª”æ¡ˆ: 5 å€‹
- æ–°å¢æª”æ¡ˆ: 2 å€‹

### é©—è­‰çµæœ

âœ… TypeScript é¡å‹æª¢æŸ¥é€šé
âœ… ESLint ä»£ç¢¼é¢¨æ ¼æª¢æŸ¥é€šé
âœ… å–®å…ƒæ¸¬è©¦é€šé (12/12)
âœ… Build æ§‹å»ºæˆåŠŸ
âœ… ç„¡ç¦æ­¢æ¨¡å¼
âœ… ç„¡æ•æ„Ÿè³‡è¨Š
âœ… ç„¡ç•°å¸¸å¤§æª”æ¡ˆ
âœ… ç›¸ä¾æ€§æ­£ç¢º

### å¯ä»¥å®‰å…¨æäº¤ âœ…

å»ºè­° commit message:
```

feat: å¯¦ä½œç”¨æˆ¶èªè­‰åŠŸèƒ½

- æ–°å¢ Login çµ„ä»¶
- å¯¦ä½œ JWT é©—è­‰
- åŠ å…¥éŒ¯èª¤è™•ç†

```

```

## ğŸš¨ å¦‚æœé©—è­‰å¤±æ•—

```markdown
## Pre-Commit é©—è­‰å ±å‘Š

### é©—è­‰çµæœ

âŒ TypeScript é¡å‹æª¢æŸ¥å¤±æ•—

- src/components/Login.tsx:42 - TS7006
- src/api/auth.ts:15 - TS2345

âœ… ESLint ä»£ç¢¼é¢¨æ ¼æª¢æŸ¥é€šé
âš ï¸ ç™¼ç¾ 3 å€‹ console.log

- src/utils/debug.ts:12
- src/components/Form.tsx:45
- src/hooks/useAuth.ts:88

### â›” ä¸å¯æäº¤ï¼

å¿…é ˆå…ˆä¿®å¾©ä»¥ä¸Šå•é¡Œã€‚
```

**è™•ç†æ­¥é©Ÿï¼š**

1. ä½¿ç”¨ç›¸æ‡‰çš„ skill ä¿®å¾©å•é¡Œï¼ˆå¦‚ `type-checker`ï¼‰
2. é‡æ–°åŸ·è¡Œå®Œæ•´é©—è­‰
3. ç›´åˆ°æ‰€æœ‰æª¢æŸ¥é€šé

## âš ï¸ çµ•å°ç¦æ­¢

```bash
# âŒ æ°¸é ä¸è¦é€™æ¨£åš
git commit --no-verify
git push --force
git commit -m "wip" # æ²’æœ‰æè¿°æ€§çš„ message
```

## âœ… æœ€ä½³å¯¦è¸

### Commit Message æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type é¡å‹ï¼š**

- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¾© bug
- `refactor`: é‡æ§‹
- `docs`: æ–‡æª”
- `style`: æ ¼å¼ï¼ˆä¸å½±éŸ¿ä»£ç¢¼é‹è¡Œï¼‰
- `test`: æ¸¬è©¦
- `chore`: æ§‹å»ºéç¨‹æˆ–è¼”åŠ©å·¥å…·è®Šå‹•

**ç¯„ä¾‹ï¼š**

```
feat(auth): å¯¦ä½œ JWT èªè­‰

- æ–°å¢ login API endpoint
- å¯¦ä½œ token é©—è­‰ middleware
- åŠ å…¥ refresh token æ©Ÿåˆ¶

Closes #123
```

## ğŸ”„ å®Œæ•´ Commit æµç¨‹

```bash
# 1. åŸ·è¡Œ pre-commit é©—è­‰ï¼ˆä½¿ç”¨æ­¤ skillï¼‰
# 2. æ‰€æœ‰æª¢æŸ¥é€šéå¾Œ
git add .

# 3. æäº¤ï¼ˆä½¿ç”¨æè¿°æ€§ messageï¼‰
git commit -m "feat: å¯¦ä½œåŠŸèƒ½"

# 4. Push å‰å†æ¬¡ç¢ºèª
git log -1 --stat

# 5. Push
git push origin branch-name
```

## ğŸ“Š æª¢æŸ¥çµ±è¨ˆ

å®Œæˆé©—è­‰å¾Œï¼Œæä¾›çµ±è¨ˆè³‡è¨Šï¼š

```markdown
### ä¿®æ”¹çµ±è¨ˆ

- ä¿®æ”¹: 8 æª”æ¡ˆ
- æ–°å¢: 245 è¡Œ
- åˆªé™¤: 102 è¡Œ
- æ¸¬è©¦è¦†è“‹ç‡: 87%

### å“è³ªæŒ‡æ¨™

- TypeScript éŒ¯èª¤: 0
- ESLint è­¦å‘Š: 0
- æ¸¬è©¦é€šéç‡: 100%
- Build æ™‚é–“: 12.3s
```

## ğŸ¯ é©—è­‰æ¨™æº–

æ‰€æœ‰æª¢æŸ¥å¿…é ˆ 100% é€šéï¼Œæ²’æœ‰ä¾‹å¤–ã€‚

**è¨˜ä½ï¼šå¯§å¯å¤šèŠ±æ™‚é–“ç¢ºä¿å“è³ªï¼Œä¹Ÿä¸è¦æäº¤æœ‰å•é¡Œçš„ä»£ç¢¼ã€‚**
