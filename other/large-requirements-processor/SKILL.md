---
name: large-requirements-processor
description: 超大型需求智能拆分与批量处理，自动识别模块边界、逐模块分析并整合文档，支持零人工干预的完整需求处理流程。
version: 1.0.0
created: 2026-01-29
---

## 功能概述

处理超大型需求（>5,000字）的智能拆分和批量处理。通过自动识别模块边界，将大型需求拆分为独立子需求，逐个分析后自动整合为完整需求文档。

---

## 核心能力

### 1. 智能模块识别
- 自动分析需求文本，识别独立功能模块
- 基于业务领域知识判断模块边界
- 识别模块间依赖关系

### 2. 自动拆分策略
- 按模块拆分（用户、商品、订单等）
- 按功能拆分（CRUD、统计、导入导出等）
- 按优先级拆分（核心功能、扩展功能等）

### 3. 流式批量处理
- 逐模块自动分析（无需人工确认）
- 实时进度反馈
- 自动冲突检测和解决

### 4. 文档自动整合
- 合并所有模块需求文档
- 生成模块依赖关系图
- 生成完整验收标准

---

## 触发条件

当检测到以下情况时自动激活：

1. **输入规模检测**
   - 输入字数 > 5,000字
   - 或包含3个以上独立模块关键词

2. **关键词识别**
   - "完整系统"、"平台"、"多个模块"
   - "用户+商品+订单"等多模块组合

---

## 工作流程

### 阶段1: 规模评估（10秒）

```
输入：15,000字的完整需求

执行：
1. 统计字数和Token数
2. 识别模块数量
3. 评估处理时间
4. 生成处理计划

输出：
📊 检测到大型需求（15,000字）
📦 识别到6个独立模块
⏱️ 预计处理时间：45-60分钟
💡 自动启动流式批量处理模式
```

### 阶段2: 模块识别（30秒）

```
执行：
1. 分析需求文本结构
2. 提取模块关键词
3. 划分模块边界
4. 识别模块依赖

输出：
✅ 模块识别完成
1. 用户模块（2,000字）- 独立
2. 商品模块（2,500字）- 独立
3. 订单模块（3,000字）- 依赖：用户、商品
4. 营销模块（2,000字）- 依赖：订单
5. 物流模块（1,500字）- 依赖：订单
6. 财务模块（1,000字）- 依赖：订单
```

### 阶段3: 逐模块分析（40-50分钟）

```
执行：
for each 模块 in 模块列表:
    1. 提取模块需求文本
    2. 调用需求分析核心流程
    3. 生成模块需求文档
    4. 检测模块内冲突
    5. 应用需求补全建议

输出：
📦 [1/6] 用户模块 ✅
📄 docs/需求文档-用户模块.md

📦 [2/6] 商品模块 ✅
📄 docs/需求文档-商品模块.md

📦 [3/6] 订单模块 ⏳ (60%)
...
```

### 阶段4: 冲突检测（5分钟）

```
执行：
1. 检测模块间数据冲突
2. 检测模块间逻辑冲突
3. 检测模块间依赖冲突
4. 自动生成解决方案

输出：
⚠️ 检测到3个模块间冲突：
1. 订单模块的user_id与用户模块的userId类型不一致
   → 自动修正为统一使用Long类型
2. 营销模块的优惠券与订单模块的优惠逻辑冲突
   → 建议在订单模块中统一处理优惠计算
3. 物流模块的订单状态与订单模块的状态定义不一致
   → 自动同步状态枚举定义
```

### 阶段5: 文档整合（5分钟）

```
执行：
1. 合并所有模块需求清单
2. 合并所有数据字典
3. 生成模块依赖关系图
4. 生成完整验收标准
5. 生成需求概览文档

输出：
📦 文档整合完成
1. 📄 需求文档-完整版.md（10,000+行）
2. 📄 模块依赖关系图.md
3. 📄 需求冲突检测报告.md
4. 📄 需求概览.md
5. 📄 需求文档-用户模块.md
6. 📄 需求文档-商品模块.md
... (各模块独立文档)
```

---

## 输出格式

### 进度反馈格式

```markdown
┌─────────────────────────────────────────┐
│     超大型需求处理进度 Dashboard         │
├─────────────────────────────────────────┤
│ 📊 总进度: ████████░░ 80% (4/5)        │
│                                         │
│ ✅ 用户模块 - 已完成（8分钟）            │
│ ✅ 商品模块 - 已完成（10分钟）           │
│ ✅ 订单模块 - 已完成（12分钟）           │
│ ⏳ 营销模块 - 进行中（60%，预计5分钟）   │
│ 🔜 物流模块 - 待处理                    │
│ 🔜 财务模块 - 待处理                    │
│                                         │
│ ⏱️ 已耗时: 35分钟                       │
│ ⏱️ 预计剩余: 15分钟                     │
│ 💰 Token消耗: 3,240 / 预算: 6,000      │
└─────────────────────────────────────────┘
```

### 最终输出格式

```markdown
✅ 超大型需求分析完成

📊 处理统计：
- 输入规模: 15,000字（11,250 tokens）
- 识别模块: 6个
- 总耗时: 48分钟
- Token消耗: 5,240
- 发现冲突: 3个（已自动解决）
- 补全建议: 28条（已自动应用）

📦 输出产物：
1. 📄 需求文档-完整版.md（10,234行）
   - 包含所有6个模块的完整需求
   - 包含完整的数据字典（82个表）
   - 包含完整的验收标准（156条）

2. 📄 模块依赖关系图.md
   - 可视化展示模块间依赖
   - 标注关键数据流转

3. 📄 需求冲突检测报告.md
   - 3个冲突已自动解决
   - 5个潜在风险需要关注

4. 📄 各模块独立文档（6份）
   - 用户模块、商品模块、订单模块
   - 营销模块、物流模块、财务模块

🔗 下一步建议：
- 使用 /dev 开始完整开发流程
- 或使用 agent@architecture-designer 进行架构设计
```

---

## 智能特性

### 1. 自适应拆分策略
根据需求特点自动选择最优拆分策略：
- 电商类 → 按业务模块拆分
- 管理系统类 → 按功能模块拆分
- 工作流类 → 按流程阶段拆分

### 2. 智能依赖识别
自动识别模块间的依赖关系：
- 数据依赖（外键关联）
- 业务依赖（流程依赖）
- 功能依赖（接口调用）

### 3. 冲突自动解决
常见冲突的自动解决策略：
- 字段类型不一致 → 统一为更通用的类型
- 状态定义冲突 → 生成统一的状态枚举
- 业务规则冲突 → 标记为需要人工确认

### 4. 进度智能预估
基于历史数据预估处理时间：
- 简单模块（CRUD）→ 5-8分钟
- 中等模块（含业务规则）→ 10-15分钟
- 复杂模块（含审批流程）→ 15-20分钟

---

## 使用示例

### 示例: 电商平台需求

```
用户输入：
agent@requirements-analyst 
我想做一个完整的电商平台，包括用户管理、商品管理、
订单管理、支付管理、营销活动、物流管理、财务对账等功能。
（详细描述15,000字）

处理流程：
📊 检测到大型需求（15,000字）
📦 识别到7个模块，启动流式处理...

[处理中...]
✅ 用户模块 - 完成
✅ 商品模块 - 完成
✅ 订单模块 - 完成
✅ 支付模块 - 完成
✅ 营销模块 - 完成
✅ 物流模块 - 完成
✅ 财务模块 - 完成

✅ 需求分析完成（总耗时52分钟）
📄 已生成8份文档（1份完整版 + 7份模块文档）
```

---

## 注意事项

### 限制条件
- 单次处理建议不超过50,000字
- 模块数量建议不超过10个
- 单个模块建议不超过5,000字

### 最佳实践
- 输入需求时保持模块间的清晰边界
- 使用标题或分隔符区分不同模块
- 提供模块间的依赖关系说明

### 异常处理
- 模块识别失败 → 降级为单一需求处理
- 冲突无法自动解决 → 生成人工确认清单
- Token超预算 → 暂停并生成中间文档

---

## 版本历史

| 版本 | 日期 | 变更内容 |
|------|------|---------|
| 1.0.0 | 2026-01-29 | 初始版本，实现超大型需求智能拆分核心功能 |

---

**技能状态**: ✅ 就绪  
**专注领域**: 超大型需求拆分、批量处理、文档整合  
**输出产物**: 完整需求文档 + 模块文档 + 依赖关系图 + 冲突报告
