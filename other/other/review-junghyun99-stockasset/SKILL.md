---
name: review
description: 현재 변경 사항을 코드 리뷰합니다. 버그, 보안 취약점, 아키텍처 위반, 테스트 누락 등을 점검합니다.
argument-hint: "[base-branch] (기본: main)"
allowed-tools: Bash(git *), Read, Grep, Glob
---

# 코드 리뷰

현재 브랜치의 변경 사항을 분석하여 코드 리뷰를 수행합니다.

## 실행 절차

### 1단계: 변경 사항 수집
- `git diff`로 스테이징되지 않은 변경 사항을 확인합니다
- `git diff --staged`로 스테이징된 변경 사항을 확인합니다
- 인자가 있으면 해당 브랜치 대비 diff를 확인합니다: `git diff $ARGUMENTS...HEAD`
- 인자가 없으면 main 브랜치 대비: `git diff main...HEAD`

### 2단계: 변경 파일 분석
각 변경 파일에 대해 전체 파일을 읽고 컨텍스트를 파악합니다.

### 3단계: 리뷰 체크리스트

다음 항목을 순서대로 점검합니다:

#### 버그 및 로직 오류
- 경계값 처리 누락 (off-by-one, None 체크, 빈 리스트 등)
- 잘못된 조건문, 무한 루프 가능성
- 타입 불일치, 잘못된 반환값

#### 보안
- 하드코딩된 비밀번호, API 키, 토큰
- .env 파일이 커밋에 포함되지 않았는지 확인
- SQL 인젝션, 커맨드 인젝션 가능성

#### 아키텍처 규칙 준수
- **core/ → infra/ 의존 방향**: core 모듈이 infra를 import하지 않는지 확인
- **인터페이스 사용**: `core/interfaces.py`에 정의된 추상 인터페이스를 통해 의존성 주입이 되는지 확인
- 백테스트가 프로덕션 로직을 재사용하는지 확인 (코드 분기 없음)

#### 코드 스타일
- 클래스: PascalCase, 함수/변수: snake_case, 상수: UPPER_SNAKE_CASE
- Python 3.10 호환성
- 타입 힌트 사용 여부

#### 테스트
- 새로운 기능에 대한 테스트가 추가되었는지 확인
- 외부 API 호출이 mock 처리되었는지 확인
- 테스트가 `tests/` 디렉토리에 `test_*.py` 형식으로 작성되었는지 확인

## 결과 출력 형식

리뷰 결과를 다음 형식으로 출력합니다:

```
## 코드 리뷰 결과

### 요약
- 변경 파일: N개
- 발견된 이슈: N개 (심각: N, 경고: N, 제안: N)

### 이슈 목록

#### [심각] 파일명:라인번호 - 이슈 제목
설명과 수정 제안

#### [경고] 파일명:라인번호 - 이슈 제목
설명과 수정 제안

#### [제안] 파일명:라인번호 - 이슈 제목
설명과 수정 제안

### 잘된 점
- 긍정적인 피드백
```

## 주의사항
- 리뷰는 읽기 전용입니다. 코드를 직접 수정하지 않습니다.
- 수정이 필요하면 이슈 목록을 제시하고 사용자가 결정하도록 합니다.
