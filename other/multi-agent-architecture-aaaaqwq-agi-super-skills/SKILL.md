---
name: multi-agent-architecture
description: å¤š Agent æ¶æ„è®¾è®¡ä¸æ™ºèƒ½ Spawn ç³»ç»Ÿã€‚å½“éœ€è¦è®¾è®¡å¤š Agent ç³»ç»Ÿã€é…ç½®ä¸“ä¸šåŒ– Agentã€å®ç°æ™ºèƒ½ä»»åŠ¡åˆ†å‘ã€æˆ–ä¼˜åŒ–å¹¶å‘å¤„ç†èƒ½åŠ›æ—¶ä½¿ç”¨æ­¤æŠ€èƒ½ã€‚
---

# Multi-Agent Architecture - å¤š Agent æ¶æ„

## æ¦‚è¿°

OpenClaw æ”¯æŒå¤š Agent æ¶æ„ï¼Œæ¯ä¸ª Agent å¯ä»¥æœ‰ä¸åŒçš„ï¼š
- ä¸“ä¸šé¢†åŸŸå’Œ System Prompt
- æ¨¡å‹é…ç½®å’Œæˆæœ¬ç­–ç•¥
- Channel ç»‘å®šå’Œæƒé™
- å·¥å…·é›†å’Œ MCP é…ç½®

## æ¶æ„è®¾è®¡

### æ¨èçš„ Agent åˆ†å·¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Main Agent (å°a)                        â”‚
â”‚  - ä¸»ä¼šè¯å¤„ç†                                                 â”‚
â”‚  - ä»»åŠ¡åˆ†å‘å’Œåè°ƒ                                             â”‚
â”‚  - å¤æ‚å†³ç­–å’Œè§„åˆ’                                             â”‚
â”‚  - æ¨¡å‹: opus-4.5 (é«˜è´¨é‡)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   News Agent    â”‚ â”‚   Code Agent    â”‚ â”‚  Research Agent â”‚
â”‚  - æ–°é—»æŠ“å–     â”‚ â”‚  - ä»£ç ç”Ÿæˆ     â”‚ â”‚  - æ·±åº¦ç ”ç©¶     â”‚
â”‚  - å†…å®¹æ‘˜è¦     â”‚ â”‚  - Bug ä¿®å¤     â”‚ â”‚  - æ–‡æ¡£åˆ†æ     â”‚
â”‚  - å®šæ—¶æ¨é€     â”‚ â”‚  - ä»£ç å®¡æŸ¥     â”‚ â”‚  - çŸ¥è¯†æ•´åˆ     â”‚
â”‚  æ¨¡å‹: sonnet   â”‚ â”‚  æ¨¡å‹: codex    â”‚ â”‚  æ¨¡å‹: opus     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
          â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Quick Agent    â”‚ â”‚  Batch Agent    â”‚ â”‚  Monitor Agent  â”‚
â”‚  - å¿«é€Ÿé—®ç­”     â”‚ â”‚  - æ‰¹é‡å¤„ç†     â”‚ â”‚  - ç³»ç»Ÿç›‘æ§     â”‚
â”‚  - ç®€å•ä»»åŠ¡     â”‚ â”‚  - æ•°æ®å¤„ç†     â”‚ â”‚  - å¥åº·æ£€æŸ¥     â”‚
â”‚  - ä½å»¶è¿Ÿå“åº”   â”‚ â”‚  - æ–‡ä»¶æ“ä½œ     â”‚ â”‚  - å‘Šè­¦é€šçŸ¥     â”‚
â”‚  æ¨¡å‹: flash    â”‚ â”‚  æ¨¡å‹: mini     â”‚ â”‚  æ¨¡å‹: mini     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Agent é…ç½®

### 1. åˆ›å»º Agent ç›®å½•ç»“æ„

```bash
~/.openclaw/agents/
â”œâ”€â”€ main/           # ä¸» Agent (å·²å­˜åœ¨)
â”‚   â””â”€â”€ agent/
â”‚       â”œâ”€â”€ AGENTS.md
â”‚       â”œâ”€â”€ SOUL.md
â”‚       â””â”€â”€ ...
â”œâ”€â”€ news/           # æ–°é—» Agent
â”‚   â””â”€â”€ agent/
â”‚       â”œâ”€â”€ AGENTS.md
â”‚       â””â”€â”€ config.json
â”œâ”€â”€ code/           # ä»£ç  Agent
â”‚   â””â”€â”€ agent/
â”‚       â”œâ”€â”€ AGENTS.md
â”‚       â””â”€â”€ config.json
â”œâ”€â”€ research/       # ç ”ç©¶ Agent
â”‚   â””â”€â”€ agent/
â”‚       â”œâ”€â”€ AGENTS.md
â”‚       â””â”€â”€ config.json
â”œâ”€â”€ quick/          # å¿«é€Ÿå“åº” Agent
â”‚   â””â”€â”€ agent/
â”‚       â””â”€â”€ config.json
â””â”€â”€ batch/          # æ‰¹é‡å¤„ç† Agent
    â””â”€â”€ agent/
        â””â”€â”€ config.json
```

### 2. Agent é…ç½®ç¤ºä¾‹

#### News Agent (`~/.openclaw/agents/news/agent/config.json`)

```json
{
  "model": {
    "primary": "anthropic/claude-sonnet-4-5"
  },
  "systemPrompt": "ä½ æ˜¯æ–°é—»æŠ“å–å’Œæ‘˜è¦ä¸“å®¶ã€‚ä¸“æ³¨äºï¼š\n1. ä»æƒå¨æ¥æºæŠ“å–çœŸå®æ–°é—»\n2. ç”Ÿæˆç®€æ´å‡†ç¡®çš„æ‘˜è¦\n3. ç¡®ä¿æ¯æ¡æ–°é—»æœ‰åŸæ–‡é“¾æ¥\n4. æŒ‰æ—¶æ¨é€åˆ°æŒ‡å®šæ¸ é“",
  "tools": {
    "allow": ["web_fetch", "exec", "message"]
  }
}
```

#### Code Agent (`~/.openclaw/agents/code/agent/config.json`)

```json
{
  "model": {
    "primary": "openrouter-vip/gpt-5.2-codex"
  },
  "systemPrompt": "ä½ æ˜¯ä»£ç ä¸“å®¶ã€‚ä¸“æ³¨äºï¼š\n1. é«˜è´¨é‡ä»£ç ç”Ÿæˆ\n2. Bug åˆ†æå’Œä¿®å¤\n3. ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–\n4. æŠ€æœ¯æ–‡æ¡£ç¼–å†™",
  "tools": {
    "allow": ["read", "write", "edit", "exec"]
  }
}
```

#### Quick Agent (`~/.openclaw/agents/quick/agent/config.json`)

```json
{
  "model": {
    "primary": "google/gemini-flash-latest"
  },
  "systemPrompt": "ä½ æ˜¯å¿«é€Ÿå“åº”åŠ©æ‰‹ã€‚ç‰¹ç‚¹ï¼š\n1. ç®€æ´ç›´æ¥çš„å›ç­”\n2. ä½å»¶è¿Ÿå“åº”\n3. å¤„ç†ç®€å•æŸ¥è¯¢\n4. ä¸éœ€è¦æ·±åº¦åˆ†æçš„ä»»åŠ¡"
}
```

### 3. åœ¨ openclaw.json ä¸­æ³¨å†Œ Agent

```json
{
  "agents": {
    "entries": {
      "news": {
        "enabled": true,
        "allowSpawnFrom": ["main"]
      },
      "code": {
        "enabled": true,
        "allowSpawnFrom": ["main"]
      },
      "research": {
        "enabled": true,
        "allowSpawnFrom": ["main"]
      },
      "quick": {
        "enabled": true,
        "allowSpawnFrom": ["main"]
      },
      "batch": {
        "enabled": true,
        "allowSpawnFrom": ["main"]
      }
    },
    "defaults": {
      "maxConcurrent": 4,
      "subagents": {
        "maxConcurrent": 8
      }
    }
  }
}
```

## æ™ºèƒ½ Spawn ç³»ç»Ÿ

### ä»»åŠ¡åˆ†ç±»è§„åˆ™

Main Agent æ ¹æ®ä»»åŠ¡ç±»å‹è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ Agentï¼š

| ä»»åŠ¡ç±»å‹ | å…³é”®è¯ | ç›®æ ‡ Agent | æ¨¡å‹ |
|----------|--------|------------|------|
| æ–°é—»æŠ“å– | news, æ–°é—», æ—©æŠ¥, æ¨é€ | news | sonnet |
| ä»£ç ä»»åŠ¡ | code, ä»£ç , bug, å¼€å‘ | code | codex |
| æ·±åº¦ç ”ç©¶ | research, åˆ†æ, è°ƒç ” | research | opus |
| å¿«é€Ÿé—®ç­” | ç®€å•, å¿«é€Ÿ, æŸ¥è¯¢ | quick | flash |
| æ‰¹é‡å¤„ç† | batch, æ‰¹é‡, æ–‡ä»¶ | batch | mini |
| å¤æ‚ä»»åŠ¡ | ä¿ç•™åœ¨ main | main | opus |

### æ™ºèƒ½ Spawn å®ç°

```python
# åœ¨ AGENTS.md ä¸­æ·»åŠ æ™ºèƒ½ Spawn é€»è¾‘

## ğŸ§  æ™ºèƒ½ä»»åŠ¡åˆ†å‘

å½“æ”¶åˆ°ä»»åŠ¡æ—¶ï¼Œè¯„ä¼°ä»¥ä¸‹å› ç´ ï¼š

1. **ä»»åŠ¡å¤æ‚åº¦**
   - ç®€å•æŸ¥è¯¢ â†’ quick agent
   - ä¸­ç­‰ä»»åŠ¡ â†’ ä¸“ä¸š agent
   - å¤æ‚ä»»åŠ¡ â†’ main å¤„ç†æˆ– research agent

2. **ä»»åŠ¡ç±»å‹**
   - æ–°é—»ç›¸å…³ â†’ news agent
   - ä»£ç ç›¸å…³ â†’ code agent
   - ç ”ç©¶åˆ†æ â†’ research agent
   - æ‰¹é‡æ“ä½œ â†’ batch agent

3. **æ—¶é—´æ•æ„Ÿåº¦**
   - éœ€è¦å¿«é€Ÿå“åº” â†’ quick agent
   - å¯ä»¥ç­‰å¾… â†’ ä¸“ä¸š agent

4. **èµ„æºæ¶ˆè€—**
   - é«˜ token æ¶ˆè€— â†’ ä½¿ç”¨ä¾¿å®œæ¨¡å‹çš„ agent
   - éœ€è¦é«˜è´¨é‡ â†’ ä½¿ç”¨ opus çš„ agent

### Spawn å‘½ä»¤ç¤ºä¾‹

```python
# æ–°é—»ä»»åŠ¡
sessions_spawn(
    task="æŠ“å–ä»Šæ—¥ç§‘æŠ€æ–°é—»å¹¶æ¨é€åˆ° DailyNews ç¾¤ç»„",
    agentId="news",
    label="news-morning"
)

# ä»£ç ä»»åŠ¡
sessions_spawn(
    task="ä¿®å¤ auth.py ä¸­çš„ç™»å½• bug",
    agentId="code",
    label="fix-auth-bug"
)

# ç ”ç©¶ä»»åŠ¡
sessions_spawn(
    task="æ·±åº¦åˆ†æ GPT-5 çš„æŠ€æœ¯æ¶æ„",
    agentId="research",
    label="gpt5-analysis"
)

# å¿«é€ŸæŸ¥è¯¢
sessions_spawn(
    task="æŸ¥è¯¢ä»Šå¤©çš„å¤©æ°”",
    agentId="quick",
    label="weather-check"
)
```

## å¹¶å‘å¤„ç†

### é…ç½®å¹¶å‘é™åˆ¶

```json
{
  "agents": {
    "defaults": {
      "maxConcurrent": 4,      // ä¸» agent æœ€å¤§å¹¶å‘
      "subagents": {
        "maxConcurrent": 8    // å­ agent æœ€å¤§å¹¶å‘
      }
    }
  }
}
```

### å¹¶å‘åœºæ™¯

```
ç”¨æˆ·æ¶ˆæ¯ â†’ Main Agent
              â”‚
              â”œâ”€â†’ spawn(news) â”€â”€â†’ æŠ“å–æ–°é—»
              â”‚
              â”œâ”€â†’ spawn(code) â”€â”€â†’ ä¿®å¤ bug
              â”‚
              â””â”€â†’ spawn(research) â”€â”€â†’ æ·±åº¦åˆ†æ
              
              â†“ (å¹¶è¡Œæ‰§è¡Œ)
              
         æ‰€æœ‰ä»»åŠ¡å®Œæˆåæ±‡æŠ¥
```

## Channel ç»‘å®š

### ä¸åŒ Channel ä½¿ç”¨ä¸åŒ Agent

```json
{
  "channels": {
    "telegram": {
      "defaultAgent": "main"
    },
    "whatsapp": {
      "defaultAgent": "main"
    }
  },
  "agents": {
    "entries": {
      "news": {
        "channels": ["telegram-newsbot"]
      }
    }
  }
}
```

## ç›‘æ§å’Œç®¡ç†

### æŸ¥çœ‹æ´»è·ƒ Session

```bash
# åˆ—å‡ºæ‰€æœ‰ session
openclaw sessions list

# æŸ¥çœ‹ç‰¹å®š agent çš„ session
openclaw sessions list --agent news
```

### æŸ¥çœ‹ Spawn çŠ¶æ€

```python
# åœ¨ä»£ç ä¸­
sessions_list(kinds=["spawn"], limit=10)
```

## æœ€ä½³å®è·µ

### 1. ä»»åŠ¡åˆ†å‘åŸåˆ™

- **ç®€å•ä»»åŠ¡ä¸ spawn** - ç›´æ¥å¤„ç†æ›´å¿«
- **è€—æ—¶ä»»åŠ¡å¿… spawn** - ä¸é˜»å¡ä¸»ä¼šè¯
- **ç›¸å…³ä»»åŠ¡æ‰¹é‡ spawn** - æé«˜æ•ˆç‡

### 2. æ¨¡å‹é€‰æ‹©åŸåˆ™

- **è´¨é‡ä¼˜å…ˆ** â†’ opus
- **é€Ÿåº¦ä¼˜å…ˆ** â†’ flash
- **ä»£ç ä»»åŠ¡** â†’ codex
- **æˆæœ¬ä¼˜å…ˆ** â†’ mini

### 3. é”™è¯¯å¤„ç†

```python
# spawn æ—¶è®¾ç½®è¶…æ—¶
sessions_spawn(
    task="...",
    agentId="code",
    runTimeoutSeconds=300,  # 5åˆ†é’Ÿè¶…æ—¶
    cleanup="keep"          # ä¿ç•™ session ç”¨äºè°ƒè¯•
)
```

## ç›¸å…³èµ„æº

- [OpenClaw Agents æ–‡æ¡£](https://docs.openclaw.ai/agents)
- [Sessions Spawn æ–‡æ¡£](https://docs.openclaw.ai/tools/sessions)
- [æ¨¡å‹é…ç½®æŒ‡å—](https://docs.openclaw.ai/models)

---

*ç”±å°aè®¾è®¡ - å®ç°çœŸæ­£çš„å¤š Agent åä½œ*
