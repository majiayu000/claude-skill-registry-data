---
user-invocable: true
description: "[バグ対応] 2. トラブルシューティング調査実行と仮説の絞り込み"
---

# [バグ対応] 2. トラブルシューティング調査実行と仮説の絞り込み (引数:Issue番号)

## 入力
- `$ARGUMENTS` : 調査対象のバグIssue番号
  - 例: `#123` または `123`

---

## 🎯 目的
- 既存のバグIssueを基に **調査だけを実施** する
- 観測結果や調査ログを **Issueコメント** で追記する
- 調査から導き出された新しい仮説を **Issue本文の「考えられる原因」** に追記・更新する
- 解決や修正はまだ行わず、あくまで **現状把握と原因候補の精度向上** に集中する

---

## GitHub連携の前提

### 必要な権限
以下の `gh` コマンドが実行可能であること：
- `gh issue view` / `gh issue edit`
- `gh issue comment`

---

## 手順

### 1. Issue内容を取得
```bash
gh issue view {ISSUE_NUMBER} --json title,body,labels
```

### 2. 調査実施
- 「調査・対処計画」を確認し、実施可能な調査を実行する
  - コード検索、ログ解析、設定ファイル確認、再現テストなど
  - 危険な操作（削除・本番DB変更・シークレット露出等）は禁止

### 3. 調査結果をコメント
```bash
gh issue comment {ISSUE_NUMBER} --body "🔍 調査報告

## 実施した調査
- {調査内容1}: {結果}
- {調査内容2}: {結果}

## 観測結果
\`\`\`
{ログ抜粋やエラーメッセージ}
\`\`\`

## 新たな知見
- {調査から得られた知見}

## 仮説の更新
- 仮説A: {検証結果 - 有力/棄却/継続調査}
- 仮説B: {検証結果}
- **新規仮説**: {調査から見えてきた新しい仮説}

## 次の調査候補
- {残課題1}
- {残課題2}
"
```

### 4. Issue本文を更新（仮説の更新）
```bash
# 現在の本文を取得して、仮説セクションを更新
gh issue edit {ISSUE_NUMBER} --body "{更新後の本文}"
```

### 5. 解決状況を更新
Issue本文の「解決状況」を `🟡 調査中` に更新する

---

## 出力（GitHub）
- **Issueコメント**: 調査内容・観測結果・知見を追記
- **Issue本文**: 仮説セクションを更新、解決状況を「🟡 調査中」に変更

---

## 品質チェックリスト
- [ ] 調査内容が **事実ベース** で記録されている
- [ ] 調査から得られた観測結果が具体的に残っている
- [ ] 新しい仮説が追加されている
- [ ] 状態が「🟡 調査中」に更新されている
- [ ] 調査過程がIssueコメントで記録されている
- [ ] 関連ファイルやログ断片が適切に紐づいている

---

## 自己評価
- **成功自信度**: (1-10)
- **一言理由**: {短く理由を記載。例: 「再現確認はできたが根本原因は未確定」}
