---
name: child-agent-ops
description: 子エージェントの起動・指示・報告・安全運用を標準化するスキル。codex でのタスク分解、確認判断、チェックリスト、テンプレートを提供し、リーダー/実装/レビュー各エージェントが迷わず動けるようにする。
---

# 子エージェント運用 Skill

## クイックスタート（3ステップ）
1. **目的と完了条件を1行で決める**（何を/いつまでに/どの状態なら完了か）。
2. **`codex` で起動ログを残す**（種別・担当範囲・完了条件・想定時間）。依頼メッセージとセットで記録。
3. **実行→即時共有→完了報告**（リスク・分岐はリアルタイム共有、完了時は成果物/リスク/次アクションを報告）。コード変更時は必ずレビューエージェントを起動。

## 役割と責務
- **リーダー**: ゴールと優先度を明示、タスク分割、子起動の承認、進行監視、次アクション決定。
- **実装**: 割り当て範囲のみを担当。障害・リスク・追加分岐は即共有。必要なら子を再分割。
- **レビュー**: 変更発生時に起動し、問題を指摘。ブロッカーはリーダーに即報告。

## いつ起動するか
- Do: 実装/調査/検証で **独立した単位** があり、並行した方が速いとき。
- Do: 高度専門タスク（性能測定、セキュリティ確認など）を分離したいとき。
- Avoid: 依存が強く分離不能、コミュニケーションコストが成果を上回るとき。

## 標準ワークフロー
1. リーダーがタスクを調査/実装/検証に分類し、優先度と期待成果を整理。
2. 自律実行可能な単位に分割し、必要な専門性ごとに子エージェントを `codex` で起動（範囲・完了条件・想定時間を記録）。
3. 担当タスク/目的/完了条件/想定時間/連絡方法を明示して割り当て。再分割が要る場合は事前にリーダーへ共有。
4. 実行中の分岐・リスクは即共有。長時間タスクはチェックポイントで中間報告（子の状況も含める）。
5. 完了時に成果物・観測事項・リスク・起動した子の結果を報告し承認を得る。
6. リーダーが次アクション（再調査/追加実装/引継ぎ）を決定しタスク一覧を更新。
7. 不要な子エージェントを停止。並列更新はリーダーが調整。
8. コードを変更/新設した場合はレビューエージェントを起動し、審査結果を共有。

## 運用チェックリスト
- **開始前**: 目的/完了条件/想定時間を決め、依頼メッセージと `codex` 起動ログを残す。
- **実行中**: 仕様不明・互換性リスク・セキュリティ/課金/データ削除を伴う変更は必ずリーダー確認。ブロッカーは即共有。
- **終了時**: 成果物（ファイル/ログ）、観測事項、リスク、次アクションをワンメモで報告。不要エージェントは停止。

## 自律判断と確認
- **要確認**: UI/APIが変わる、互換性影響が読めない、セキュリティ/課金/データ削除の高リスク変更。
- **自律可**: 文言・ログ改善、小規模スタイル調整、一般原則で自明な実装詳細。迷ったら暫定案を示し確認。

## コミュニケーション / レポート
- リスクやブロッカーは即時共有。長時間タスクはチェックポイントごとに現状を送る。
- 起動/停止時は理由・担当範囲・完了状況をワンライナーで残し、タスクログに紐付ける。

## 報告テンプレート
- タスク報告
  ```md
  [目的]
  - XXX の YYY を実装するため

  [現状]
  - ZZZ まで完了、AAA が未着手

  [問題]
  - ...

  [次アクション]
  - ...
  ```
- 子エージェント起動ログ
  ```md
  [子エージェント起動]
  - 種別: 実装 / 調査 / 検証
  - タスクID: TASK-123
  - 担当範囲: ...
  - 完了条件: ...
  - 想定所要時間: ...
  ```

## コマンド運用
- 許可コマンド: `codex`。起動前に意図を共有し、実行ログは報告に添付する。
- 実装エージェントが自律で子を起動する際も事前にリーダーへ意図共有。
- コード変更/新設時はレビューエージェントを必ず起動し、結果をログに残す。

## 安全運用とKPI
- 並列更新はリーダーが調整し競合を回避。外部アクセスや高リスク操作は事前承認。
- 長時間タスクはチェックポイントを設定し進捗を可視化。終了時に不要エージェントを停止。
- 定期確認: 再実行率、子エージェントの平均起動/完了時間、PRレビュー指摘件数、重大インシデント件数。
