---
name: refactoring
description: |
  Martin Fowlerã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ–¹æ³•è«–ã«åŸºã¥ã„ãŸä½“ç³»çš„ãªã‚³ãƒ¼ãƒ‰æ”¹å–„ã‚¹ã‚­ãƒ«ã€‚
  ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ã®æ¤œå‡ºã‹ã‚‰å®‰å…¨ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®å®Ÿæ–½ã¾ã§ã€ãƒ†ã‚¹ãƒˆã‚’å®‰å…¨ç¶²ã¨ã—ã¦
  æ®µéšçš„ã«å“è³ªã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚ã€Œ2ã¤ã®å¸½å­ã€ã‚’æ„è­˜ã—ã€æ©Ÿèƒ½è¿½åŠ ã¨åˆ†é›¢ã—ã¦å®Ÿæ–½ã€‚
---

# Refactoring Skill

å¤–éƒ¨ã‹ã‚‰è¦‹ãŸæŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆãšã«ã€å†…éƒ¨ã®æ§‹é€ ã‚’æ”¹å–„ã™ã‚‹ã‚¹ã‚­ãƒ«ã€‚

## å¯¾å¿œé ˜åŸŸ

| é ˜åŸŸ | ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ | è©³ç´°ã‚¬ã‚¤ãƒ‰ |
|------|-----------|-----------|
| Code Smell Detection | ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ã®ç‰¹å®šã¨å„ªå…ˆé †ä½ä»˜ã‘ | `./agents/code-smell-detector.md` |
| Backend | Python/FastAPIã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° | `./agents/backend-refactorer.md` |
| Frontend | TypeScript/SvelteKitã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° | `./agents/frontend-refactorer.md` |

## åˆ¤æ–­ãƒ•ãƒ­ãƒ¼

```
ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå¿…è¦ãªçŠ¶æ³ã¯ï¼Ÿ
â”‚
â”œâ”€ å¤§è¦æ¨¡ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®æ”¹å–„ â”€â”€â”€â”€â”€â”€â”€â”€â†’ âœ… ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸¦åˆ—å®Ÿè¡Œ
â”‚
â”œâ”€ Backend/Frontendä¸¡æ–¹ã®æ”¹å–„ â”€â”€â”€â”€â†’ âœ… ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸¦åˆ—å®Ÿè¡Œ
â”‚
â”œâ”€ å˜ä¸€ã®é–¢æ•°/ã‚¯ãƒ©ã‚¹ã®æ”¹å–„ â”€â”€â”€â”€â”€â”€â”€â”€â†’ âœ… ç›´æ¥ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
â”‚
â”œâ”€ å¤‰æ•°å/ãƒ¡ã‚½ãƒƒãƒ‰åã®å¤‰æ›´ã®ã¿ â”€â”€â”€â†’ âœ… ç›´æ¥ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆè»½é‡ï¼‰
â”‚
â”œâ”€ ãƒ†ã‚¹ãƒˆãŒãªã„/ä¸ååˆ† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ âŒ å…ˆã«ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
â”‚
â”œâ”€ æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹ç›´å‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ âŒ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å»¶æœŸ
â”‚
â””â”€ æ©Ÿèƒ½è¿½åŠ ã¨åŒæ™‚ã«è¡ŒãŠã†ã¨ã™ã‚‹ â”€â”€â†’ âŒ åˆ¥ã€…ã«å®Ÿæ–½
```

## ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸¦åˆ—ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

å¤§è¦æ¨¡ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå¿…è¦ãªå ´åˆã€å°‚é–€ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä¸¦åˆ—èµ·å‹•ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. åˆ†æãƒ•ã‚§ãƒ¼ã‚º                                              â”‚
â”‚    â””â”€â”€ Code Smell Detector ã§ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ã‚’ç‰¹å®š              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚º                                              â”‚
â”‚    â””â”€â”€ æ¤œå‡ºçµæœã«åŸºã¥ã„ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è¨ˆç”»ã‚’ç­–å®š          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚ºï¼ˆä¸¦åˆ—å¯èƒ½ï¼‰                                  â”‚
â”‚    â”œâ”€â”€ Backend Refactorer  â†’ Pythonã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°  â”‚
â”‚    â””â”€â”€ Frontend Refactorer â†’ TypeScriptã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. æ¤œè¨¼ãƒ•ã‚§ãƒ¼ã‚º                                              â”‚
â”‚    â””â”€â”€ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¨å‹•ä½œç¢ºèª                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŸºæœ¬åŸå‰‡ï¼ˆMartin Fowlerï¼‰

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¨ã¯

> ã€Œå¤–éƒ¨ã‹ã‚‰è¦‹ãŸæŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆãšã«ã€å†…éƒ¨ã®æ§‹é€ ã‚’æ”¹å–„ã™ã‚‹ã“ã¨ã€

**é‡è¦ãªç‰¹æ€§**:
- å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§é€²ã‚ã‚‹
- å„ã‚¹ãƒ†ãƒƒãƒ—å¾Œã«ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèª
- æ–°æ©Ÿèƒ½ã®è¿½åŠ ã¨ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’æ··ãœãªã„

### 2ã¤ã®å¸½å­

```
ğŸ© æ©Ÿèƒ½è¿½åŠ ã®å¸½å­          ğŸ§¢ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®å¸½å­
â”œâ”€â”€ æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ        â”œâ”€â”€ ã‚³ãƒ¼ãƒ‰ã®æ§‹é€ ã‚’æ”¹å–„
â”œâ”€â”€ æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¯å¤‰æ›´ã—ãªã„  â”œâ”€â”€ æ©Ÿèƒ½ã¯è¿½åŠ ã—ãªã„
â””â”€â”€ ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ            â””â”€â”€ æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Šç¶šã‘ã‚‹

âš ï¸ ä¸¡æ–¹ã®å¸½å­ã‚’åŒæ™‚ã«ã‹ã¶ã‚‰ãªã„ï¼
```

### 3å›ã®æ³•å‰‡

```
1å›ç›®: ã¨ã«ã‹ãå®Ÿè£…ã™ã‚‹
2å›ç›®: ä¼¼ãŸã‚ˆã†ãªã“ã¨ã‚’ã™ã‚‹æ™‚ã€é‡è¤‡ã‚’æ„Ÿã˜ã¤ã¤ã‚‚é€²ã‚ã‚‹
3å›ç›®: åŒã˜ã“ã¨ã‚’3å›ç›®ã«ã™ã‚‹æ™‚ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹
```

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆ5ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                       â”‚
    â–¼                                                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚æº–å‚™    â”‚â”€â”€â†’â”‚ãƒ†ã‚¹ãƒˆ  â”‚â”€â”€â†’â”‚å°ã•ãª  â”‚â”€â”€â†’â”‚ç¹°ã‚Šè¿”ã—â”‚         â”‚
â”‚        â”‚   â”‚ç¢ºèª    â”‚   â”‚ã‚¹ãƒ†ãƒƒãƒ—â”‚   â”‚        â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                                            â”‚              â”‚
                                            â–¼              â”‚
                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
                                       â”‚å®Œäº†ç¢ºèªâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 1: æº–å‚™

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèª | å¯¾è±¡ã‚³ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª |
| ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ç‰¹å®š | å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è­˜åˆ¥ |
| ç¯„å›²æ±ºå®š | å½±éŸ¿ç¯„å›²ã‚’ç‰¹å®šã€å°ã•ãªå˜ä½ã«åˆ†å‰² |

### Step 2: ãƒ†ã‚¹ãƒˆã®ç¢ºèª

```bash
# Backend
poetry run pytest
poetry run pytest --cov=src --cov-report=term-missing

# Frontend
npm run test
```

- ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒã‚°ãƒªãƒ¼ãƒ³ã§ã‚ã‚‹ã“ã¨
- ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒååˆ†ã§ã‚ã‚‹ã“ã¨ï¼ˆç›®æ¨™: 80%ä»¥ä¸Šï¼‰

### Step 3: å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§å¤‰æ›´

1. **1ã¤ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’é¸æŠ** â†’ æœ€å°å˜ä½ã«åˆ†è§£
2. **å¤‰æ›´ã‚’é©ç”¨** â†’ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«/æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
3. **ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ** â†’ `poetry run pytest -x`
4. **ã‚³ãƒŸãƒƒãƒˆ** â†’ å°ã•ãªå˜ä½ã§ã‚³ãƒŸãƒƒãƒˆ

### Step 4: ç¹°ã‚Šè¿”ã—

- Step 3ã‚’ç¹°ã‚Šè¿”ã™
- å„ã‚¹ãƒ†ãƒƒãƒ—å¾Œã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- å•é¡ŒãŒã‚ã‚Œã°å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

### Step 5: å®Œäº†ç¢ºèª

- å…¨ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå¤‰æ›´å‰å¾Œã®æ¯”è¼ƒï¼‰
- å‹•ä½œç¢ºèªï¼ˆé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ã®ç¢ºèªï¼‰

## ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ä¸€è¦§

### Bloatersï¼ˆè‚¥å¤§åŒ–ï¼‰

| ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ« | ç—‡çŠ¶ | å¯¾å‡¦æ³• |
|-------------|------|--------|
| Long Method | é•·ã™ãã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ | Extract Method |
| Large Class | è²¬å‹™ãŒå¤šã™ãã‚‹ã‚¯ãƒ©ã‚¹ | Extract Class |
| Primitive Obsession | ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã®å¤šç”¨ | Replace Primitive with Object |
| Long Parameter List | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå¤šã™ãã‚‹ | Introduce Parameter Object |

### Object-Orientation Abusersï¼ˆOOPé•åï¼‰

| ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ« | ç—‡çŠ¶ | å¯¾å‡¦æ³• |
|-------------|------|--------|
| Switch Statements | æ¡ä»¶åˆ†å²ã®å¤šç”¨ | Replace Conditional with Polymorphism |
| Temporary Field | æ™‚ã€…ã—ã‹ä½¿ã‚ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | Extract Class |
| Refused Bequest | ç¶™æ‰¿ã®èª¤ç”¨ | Replace Inheritance with Delegation |

### Change Preventersï¼ˆå¤‰æ›´å›°é›£ï¼‰

| ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ« | ç—‡çŠ¶ | å¯¾å‡¦æ³• |
|-------------|------|--------|
| Divergent Change | 1ã¤ã®ã‚¯ãƒ©ã‚¹ãŒè¤‡æ•°ã®ç†ç”±ã§å¤‰æ›´ | Extract Class |
| Shotgun Surgery | 1ã¤ã®å¤‰æ›´ãŒè¤‡æ•°ã‚¯ãƒ©ã‚¹ã«å½±éŸ¿ | Move Method, Move Field |

### Dispensablesï¼ˆä¸è¦ãªã‚‚ã®ï¼‰

| ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ« | ç—‡çŠ¶ | å¯¾å‡¦æ³• |
|-------------|------|--------|
| Duplicate Code | é‡è¤‡ã‚³ãƒ¼ãƒ‰ | Extract Method, Pull Up Method |
| Dead Code | ä½¿ã‚ã‚Œã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ | å‰Šé™¤ |
| Speculative Generality | éå‰°ãªæ±ç”¨åŒ– | ä¸è¦ãªæŠ½è±¡åŒ–ã‚’å‰Šé™¤ |

### Couplersï¼ˆçµåˆåº¦ã®å•é¡Œï¼‰

| ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ« | ç—‡çŠ¶ | å¯¾å‡¦æ³• |
|-------------|------|--------|
| Feature Envy | ä»–ã‚¯ãƒ©ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å¤šç”¨ | Move Method |
| Inappropriate Intimacy | ã‚¯ãƒ©ã‚¹é–“ã®éåº¦ãªçµåˆ | Move Method, Extract Class |
| Message Chains | é•·ã„ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ | Hide Delegate |

## ä¸»è¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚«ã‚¿ãƒ­ã‚°

### Extract Methodï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ã®æŠ½å‡ºï¼‰

```python
# Before: é•·ã„ãƒ¡ã‚½ãƒƒãƒ‰
def print_owing(self):
    print("***********************")
    print("*** Customer Owes ***")
    print("***********************")
    outstanding = sum(order.amount for order in self._orders)
    print(f"name: {self._name}")
    print(f"amount: {outstanding}")

# After: ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŠ½å‡º
def print_owing(self):
    self._print_banner()
    outstanding = self._calculate_outstanding()
    self._print_details(outstanding)

def _print_banner(self): ...
def _calculate_outstanding(self) -> float: ...
def _print_details(self, outstanding: float): ...
```

### Extract Classï¼ˆã‚¯ãƒ©ã‚¹ã®æŠ½å‡ºï¼‰

```python
# Before: è²¬å‹™ãŒå¤šã™ãã‚‹ã‚¯ãƒ©ã‚¹
class Person:
    def __init__(self, name: str, office_area_code: str, office_number: str):
        self._name = name
        self._office_area_code = office_area_code
        self._office_number = office_number

# After: é›»è©±ç•ªå·ã‚’åˆ¥ã‚¯ãƒ©ã‚¹ã«æŠ½å‡º
@dataclass
class TelephoneNumber:
    area_code: str
    number: str

class Person:
    def __init__(self, name: str, telephone: TelephoneNumber):
        self._name = name
        self._telephone = telephone
```

### Replace Conditional with Polymorphism

```python
# Before: switchæ–‡ã«ã‚ˆã‚‹æ¡ä»¶åˆ†å²
def calculate_pay(employee_type: str, hours: int) -> float:
    if employee_type == "engineer":
        return hours * 50
    elif employee_type == "manager":
        return hours * 75 + bonus()
    # ...

# After: ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ã‚’ä½¿ç”¨
class Employee(ABC):
    @abstractmethod
    def calculate_pay(self, hours: int) -> float: pass

class Engineer(Employee):
    def calculate_pay(self, hours: int) -> float:
        return hours * 50
```

## å®‰å…¨ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«

### DO âœ…

- **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å‰ã«ãƒ†ã‚¹ãƒˆãŒã‚°ãƒªãƒ¼ãƒ³ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
- **å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—**: 1ã¤ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’å®Œäº† â†’ ãƒ†ã‚¹ãƒˆ â†’ ã‚³ãƒŸãƒƒãƒˆ â†’ æ¬¡ã¸
- **æ©Ÿèƒ½è¿½åŠ ã¨ã®åˆ†é›¢**: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’å®Œäº†ã—ã¦ã‹ã‚‰æ©Ÿèƒ½è¿½åŠ 
- **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æº–å‚™**: `git reset --hard HEAD` ã§å³åº§ã«æˆ»ã‚Œã‚‹çŠ¶æ…‹ã‚’ç¶­æŒ

### DON'T âŒ

- è¤‡æ•°ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’åŒæ™‚ã«å®Ÿæ–½
- ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã›ãšã«é€²ã‚ã‚‹
- ã€Œã¤ã„ã§ã«æ©Ÿèƒ½ã‚‚è¿½åŠ ã—ã‚ˆã†ã€
- ã€Œã“ã®ãƒã‚°ã‚‚ä¸€ç·’ã«ç›´ãã†ã€

## ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

### Domainå±¤

```python
# Before: ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã®å¤šç”¨
class Order:
    def __init__(self, amount: float, currency: str): ...

# After: å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æŠ½å‡º
@dataclass(frozen=True)
class Money:
    amount: Decimal
    currency: str

class Order:
    def __init__(self, total: Money): ...
```

### UseCaseå±¤

```python
# Before: è¤‡æ•°ã®è²¬å‹™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
class UserUseCase:
    def create_user(self, data): ...
    def update_user(self, id, data): ...
    def delete_user(self, id): ...

# After: å˜ä¸€è²¬å‹™ã«åˆ†å‰²
class CreateUserUseCase:
    def execute(self, input: CreateUserInput) -> CreateUserOutput: ...
```

### APIå±¤

```python
# Before: ãƒ«ãƒ¼ã‚¿ãƒ¼ã«ãƒ­ã‚¸ãƒƒã‚¯ãŒæ··åœ¨
@router.post("/users")
async def create_user(data: dict):
    if not data.get("email"):
        raise HTTPException(400, "Email required")
    # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒã“ã“ã«...

# After: ãƒ«ãƒ¼ã‚¿ãƒ¼ã¯è–„ã
@router.post("/users", response_model=UserResponse)
async def create_user(
    data: UserCreateRequest,
    usecase: CreateUserUseCase = Depends(get_create_user_usecase)
):
    return await usecase.execute(data)
```

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ğŸ”´ é–‹å§‹å‰ï¼ˆå¿…é ˆï¼‰

- [ ] ãƒ†ã‚¹ãƒˆãŒå­˜åœ¨ã—ã€ã™ã¹ã¦ã‚°ãƒªãƒ¼ãƒ³
- [ ] ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ã‚’ç‰¹å®šã—ãŸ
- [ ] ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ç¯„å›²ã‚’æ±ºã‚ãŸ
- [ ] å½±éŸ¿ç¯„å›²ã‚’æŠŠæ¡ã—ãŸ

### ğŸŸ¡ å„ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰

- [ ] 1ã¤ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ã¿ã‚’å®Ÿæ–½
- [ ] ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ãŸ
- [ ] ãƒ†ã‚¹ãƒˆãŒã‚°ãƒªãƒ¼ãƒ³
- [ ] å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ãŸ

### ğŸŸ¢ å®Œäº†æ™‚

- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒã‚°ãƒªãƒ¼ãƒ³
- [ ] ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ãŒå‘ä¸Šã—ãŸ
- [ ] æ–°ãŸãªã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«ãŒç™ºç”Ÿã—ã¦ã„ãªã„

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### DO âœ…

- ãƒ†ã‚¹ãƒˆã‚’å®‰å…¨ç¶²ã¨ã—ã¦æ´»ç”¨
- å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§é€²ã‚ã‚‹
- å„ã‚¹ãƒ†ãƒƒãƒ—å¾Œã«ã‚³ãƒŸãƒƒãƒˆ
- 80%ã®æ”¹å–„ã§è‰¯ã—ã¨ã™ã‚‹
- æ®‹ã‚Šã¯æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§

### DON'T âŒ

- ãƒ†ã‚¹ãƒˆãªã—ã§ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- å¤§ããªå¤‰æ›´ã‚’ä¸€åº¦ã«å®Ÿæ–½
- æ©Ÿèƒ½è¿½åŠ ã¨åŒæ™‚ã«å®Ÿæ–½
- å®Œç’§ä¸»ç¾©ã«é™¥ã‚‹
- ç¯„å›²ã‚’åºƒã’ã™ãã‚‹

## å‚ç…§ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|---------|------|
| `./agents/code-smell-detector.md` | ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ¡ãƒ«æ¤œå‡ºè©³ç´° |
| `./agents/backend-refactorer.md` | Backendãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è©³ç´° |
| `./agents/frontend-refactorer.md` | Frontendãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è©³ç´° |
| `.claude/rules/code-style.md` | ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«è¦ç´„ |
| `.claude/rules/backend/layer-rules.md` | Backendãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ«ãƒ¼ãƒ« |

## å‚è€ƒè³‡æ–™

- Martin Fowlerã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼ˆç¬¬2ç‰ˆï¼‰ã€
- Refactoring Guru: https://refactoring.guru/
